# n8n Worker Configuration for Queue Processing
# Based on official n8n self-hosted setup: https://github.com/n8n-io/self-hosted-ai-starter-kit
replicaCount: {{ .nuon.install.inputs.worker_replicas }}

image:
  repository: n8nio/n8n
  tag: latest
  pullPolicy: IfNotPresent

deployment:
  command:
    - n8n
    - worker
    - --concurrency={{ .nuon.install.inputs.worker_concurrency }}

config:
  database:
    postgresdb:
      database: n8n
      user: n8n
      password: changeme123
  
  redis:
    host: redis-master
    port: "6379"
    password: changeme123
    db: "0"

secret:
  encryption_key: changeme-encryption-key-32chars

extraEnv:
  EXECUTIONS_MODE: "queue"
  N8N_LOG_LEVEL: {{ .nuon.install.inputs.log_level }}
  OLLAMA_HOST: "http://ollama-server.n8n.svc.cluster.local:11434"

resources:
  requests:
    memory: "512Mi"
    cpu: "500m"
  limits:
    memory: "2Gi"
    cpu: "2000m"


